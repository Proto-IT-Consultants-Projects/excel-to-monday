import{slicedToArray as e,defineProperty as n,toConsumableArray as o}from"../../../_virtual/_rollupPluginBabelHelpers.js";import{getTestId as t,ComponentDefaultTestId as i}from"../../tests/testIds.js";import r from"classnames";import"../../constants/dialog.js";import{SIZES as a}from"../../constants/sizes.js";import"../../constants/positions.js";import s,{forwardRef as l,useRef as c,useMemo as u,useState as d,useEffect as p,useCallback as m}from"react";import f,{createFilter as O,components as v}from"react-select";import g from"react-select/async";import b from"react-select/base";import{noop as j}from"lodash-es";import C from"./components/menu/menu.js";import M from"./components/DropdownIndicator/DropdownIndicator.js";import y from"./components/option/option.js";import h from"./components/singleValue/singleValue.js";import w from"./components/ClearIndicator/ClearIndicator.js";import S from"./components/MultiValueContainer/MultiValueContainer.js";import{isClient as I}from"../../utils/ssr-utils.js";import{DROPDOWN_CHIP_COLORS as D,DROPDOWN_MENU_PLACEMENT as R,DROPDOWN_MENU_POSITION as P,ADD_AUTO_HEIGHT_COMPONENTS as V,defaultCustomStyles as A,DROPDOWN_ID as L,DROPDOWN_MENU_ID as W,DROPDOWN_MENU_ARIA_LABEL as z,DROPDOWN_INPUT_ARIA_LABEL as E}from"./DropdownConstants.js";import T,{customTheme as x}from"./Dropdown.styles.js";import N from"./components/Control/Control.js";import F from"./components/menu/menu.module.scss.js";import B from"./Dropdown.module.scss.js";import{withStaticProps as k}from"../../types/withStaticProps.js";var H=l((function(a,l){var O=a.className,D=a.optionWrapperClassName,R=a.singleValueWrapperClassName,P=a.dropdownMenuWrapperClassName,k=a.placeholder,G=void 0===k?"":k,K=a.disabled,U=void 0!==K&&K,_=a.readOnly,q=void 0!==_&&_,J=a.withReadOnlyStyle,Q=a.onMenuOpen,X=void 0===Q?j:Q,Y=a.onMenuClose,Z=void 0===Y?j:Y,$=a.onFocus,ee=void 0===$?j:$,ne=a.onBlur,oe=void 0===ne?j:ne,te=a.onScroll,ie=void 0===te?j:te,re=a.onMenuScrollToBottom,ae=void 0===re?j:re,se=a.onChange,le=void 0===se?j:se,ce=a.searchable,ue=void 0===ce||ce,de=a.captureMenuScroll,pe=void 0!==de&&de,me=a.options,fe=void 0===me?[]:me,Oe=a.defaultValue,ve=a.value,ge=a.noOptionsMessage,be=a.openMenuOnFocus,je=a.openMenuOnClick,Ce=a.clearable,Me=void 0===Ce||Ce,ye=a.OptionRenderer,he=a.optionRenderer,we=a.ValueRenderer,Se=a.valueRenderer,Ie=a.menuRenderer,De=a.menuPlacement,Re=void 0===De?H.menuPlacements.BOTTOM:De,Pe=a.rtl,Ve=a.size,Ae=void 0===Ve?H.sizes.MEDIUM:Ve,Le=a.asyncOptions,We=a.cacheOptions,ze=a.defaultOptions,Ee=a.isVirtualized,Te=a.menuPortalTarget,xe=a.extraStyles,Ne=void 0===xe?A:xe,Fe=a.maxMenuHeight,Be=a.menuIsOpen,ke=a.tabIndex,He=void 0===ke?"0":ke,Ge=a.id,Ke=void 0===Ge?L:Ge,Ue=a.menuId,_e=void 0===Ue?W:Ue,qe=a.menuAriaLabel,Je=void 0===qe?z:qe,Qe=a.inputAriaLabel,Xe=void 0===Qe?E:Qe,Ye=a.autoFocus,Ze=void 0!==Ye&&Ye,$e=a.multi,en=void 0!==$e&&$e,nn=a.multiline,on=void 0!==nn&&nn,tn=a.onOptionRemove,rn=a.onOptionSelect,an=a.onClear,sn=a.onInputChange,ln=void 0===sn?j:sn,cn=a.closeMenuOnSelect,un=void 0===cn?!en:cn,dn=a.closeMenuOnScroll,pn=void 0!==dn&&dn,mn=a.withMandatoryDefaultOptions,fn=void 0!==mn&&mn,On=a.isOptionSelected,vn=a.insideOverflowContainer,gn=void 0!==vn&&vn,bn=a.insideOverflowWithTransformContainer,jn=void 0!==bn&&bn,Cn=a.tooltipContent,Mn=void 0===Cn?"":Cn,yn=a.onKeyDown,hn=void 0===yn?j:yn,wn=a.isLoading,Sn=void 0!==wn&&wn,In=a.loadingMessage,Dn=a.ariaLabel,Rn=a.tabSelectsValue,Pn=void 0===Rn||Rn,Vn=a.popupsContainerSelector,An=a.filterOption,Ln=a.menuPosition,Wn=void 0===Ln?H.menuPositions.ABSOLUTE:Ln,zn=a["data-testid"],En=a.withGroupDivider,Tn=void 0!==En&&En,xn=c(),Nn=Te||Vn&&document.querySelector(Vn),Fn=u((function(){return Oe?Array.isArray(Oe)?Oe.map((function(e){return Object.assign(Object.assign({},e),{isMandatory:!0})})):Object.assign(Object.assign({},Oe),{isMandatory:!0}):Oe}),[Oe]);b.prototype.renderLiveRegion=function(){return null};var Bn=d(null),kn=e(Bn,2),Hn=kn[0],Gn=kn[1];p((function(){I()&&import("react-windowed-select").then((function(e){Gn((function(){return e.WindowedMenuList}))}))}),[]);var Kn=d(Fn||[]),Un=e(Kn,2),_n=Un[0],qn=Un[1],Jn=d(""),Qn=e(Jn,2),Xn=Qn[0],Yn=Qn[1],Zn=he||ye,$n=Se||we,eo=!!ve,no=null!=ve?ve:_n,oo=u((function(){return Array.isArray(no)?no.reduce((function(e,o){return Object.assign(Object.assign({},e),n({},o.value,o))}),{}):{}}),[no]),to=u((function(){return Dn||"".concat(q?"Readonly ":""," ").concat(Mn," ").concat(Array.isArray(no)?"Selected: ".concat(no.map((function(e){return e.label})).join(", ")):"Select")}),[Dn,q,no,Mn]),io=en?no:ve,ro=u((function(){var o=T({size:Ae,rtl:Pe,insideOverflowContainer:gn,controlRef:xn,insideOverflowWithTransformContainer:jn,withGroupDivider:Tn}),t=Ne(o),i=Object.entries(t).reduce((function(t,i){var r=e(i,2),a=r[0],s=r[1];return Object.assign(Object.assign({},t),n({},a,(function(e,n){var t=o[a],i=t?t(e,n):e;return s(i,n)})))}),{});if(en){on&&V.forEach((function(e){var n=i[e];i[e]=function(e,o){return Object.assign(Object.assign({},n(e,o)),{height:"auto"})}}));var r=i.valueContainer;i.valueContainer=function(e,n){return Object.assign(Object.assign({},r(e,n)),{paddingLeft:6})}}return i}),[Ae,Pe,gn,jn,Ne,en,on]),ao=m((function(e){return s.createElement(C,Object.assign({},e,{id:_e,ariaLabel:Je,Renderer:Ie,dropdownMenuWrapperClassName:P,onScroll:ie}))}),[P,Ie,_e,Je,ie]),so=m((function(e){return s.createElement(M,Object.assign({},e,{size:Ae}))}),[Ae]),lo=m((function(e){return s.createElement(y,Object.assign({setFocusedOptionId:Yn},e,{Renderer:Zn,optionWrapperClassName:D}))}),[Zn,D,Yn]),co=m((function(e){var n=e.selectProps,o=n.focusedOptionId,t=n.menuIsOpen;return s.createElement(v.Input,Object.assign({},e,{"aria-activedescendant":o&&t?o:"",role:"combobox","aria-expanded":!q&&t,"aria-label":Xe,"aria-controls":_e}))}),[_e,q]),uo=m((function(e){return s.createElement(h,Object.assign({},e,{readOnly:q,Renderer:$n,selectedOption:no[0],singleValueWrapperClassName:R}))}),[$n,q,no,R]),po=m((function(e){return s.createElement(w,Object.assign({},e,{size:Ae}))}),[Ae]),mo=u((function(){return function(e,n){tn&&tn(oo[e]);var o=Array.isArray(no)?no.filter((function(n){return n.value!==e})):no;le&&le(o,n),qn(o)}}),[le,tn,no,oo]),fo=u((function(){return{selectedOptions:no,onSelectedDelete:mo,isMultiline:on,insideOverflowContainer:gn,insideOverflowWithTransformContainer:jn,controlRef:xn,tooltipContent:Mn,popupsContainerSelector:Vn,size:Ae}}),[no,mo,on,gn,jn,Mn,Vn,Ae]),Oo=Le?g:f,vo=Object.assign({},Le&&Object.assign({loadOptions:Le,cacheOptions:We},ze&&{defaultOptions:ze})),go=Object.assign(Object.assign({},!Le&&{options:fe}),en&&{isMulti:!0}),bo=m((function(e){var n,o=e.target;return!(null===(n=null==o?void 0:o.parentElement)||void 0===n?void 0:n.classList.contains(F.dropdownMenuWrapper))&&(pn||gn||jn)}),[gn,jn,pn]);return s.createElement(Oo,Object.assign({className:r(B.dropdown,O),selectProps:fo,components:Object.assign(Object.assign({DropdownIndicator:so,Menu:ao,ClearIndicator:po,Input:co,Option:lo,Control:N,SingleValue:uo},en&&{MultiValue:j,ValueContainer:S}),Ee&&Hn&&{MenuList:Hn}),closeMenuOnScroll:bo,size:Ae,noOptionsMessage:ge,placeholder:G,isDisabled:U,isClearable:!q&&Me,isSearchable:!q&&ue,readOnly:q,withReadOnlyStyle:J,"aria-readonly":q,"aria-label":to,"aria-details":Mn,"aria-haspopup":"listbox",defaultValue:Oe,value:io,onMenuOpen:X,onMenuClose:Z,onFocus:ee,onBlur:oe,onMenuScrollToBottom:ae,captureMenuScroll:pe,onChange:function(e,n){switch(le&&le(e,n),n.action){case"select-option":var t=en?n.option:e;rn&&rn(t),eo||qn([].concat(o(no),[t]));break;case"clear":an&&an(),eo||qn(fn?Fn:[])}},onKeyDown:hn,onInputChange:ln,openMenuOnFocus:be,openMenuOnClick:je,focusedOptionId:Xn,isRtl:Pe,styles:ro,theme:x,maxMenuHeight:Fe,menuPortalTarget:Nn,menuPlacement:Re,menuPosition:Wn,menuIsOpen:!q&&Be,tabIndex:He,id:Ke,"data-testid":zn||t(i.DROPDOWN,Ke),autoFocus:Ze,closeMenuOnSelect:un,ref:l,withMandatoryDefaultOptions:fn,isOptionSelected:On,isLoading:Sn,loadingMessage:In,tabSelectsValue:Pn,filterOption:An},vo,go))})),G=k(H,{size:a,sizes:a,chipColors:D,menuPlacements:R,menuPositions:P,createFilter:O});export{G as default};
//# sourceMappingURL=Dropdown.js.map
